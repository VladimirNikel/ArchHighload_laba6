# Архитектура высоконагруженных система. ДЗ №6
## Создание системы мониторинга на подобии ***VictoriaMetrics***


## Цель:
Необходимо:
> 1. Реализовать свою систему мониторинга (лучше всего *VicroriaMetrics*);
> 1. Развернуть её на сервере, где располагаются части задания №5;
> 1. Показать ***что*** и ***как*** запрашивается в нашей системе мониторинга;
> 1. А также, где в коде можно добавить алертинг.  


## Инструкция по установке:
1. Скачать/стянуть репозиторий 
1. Перейти в папку репозитория
1. На сервере/серверах убедиться, что docker-контейнеры подняты, если нет, то проделать следующие пункты:
    1. Выполнить команду `docker build -t <название образа> -f dockerfile . `, мною для работы используется исходный образ ubuntu. Поэтому для создания образов использую команды:
        * `docker build -t ubuntu/archhightload_laba6_1 -f dockerfile1 .`
        * `docker build -t ubuntu/archhightload_laba6_2 -f dockerfile2 .`
    1. Выполнить команду `docker run -it --name <название контейнера> -p 0.0.0.0:<порт>:8000 ubuntu/archhightload_laba2` для создания docker-контейнера из docker-образа. В рамках задания были выполнены команды:
        * `docker run -td --name laba6_1_archHL --restart on-failure -p 0.0.0.0:5020:8000 ubuntu/archhightload_laba6_1`
        * `docker run -td --name laba6_2_archHL --restart on-failure -p 0.0.0.0:5030:8000 ubuntu/archhightload_laba6_2`
1. На третьем сервере необходимо установить Nginx (инструкция приложена) и прописать в конфигурационном файле `/etc/nginx/nginx.config` как в приложенном к репозиторию одноименном файле.
1. Потом выполнить команду перезапуска Nginx'а: `nginx -s reload`
1. Далее воспользуйтесь либо браузером по [адресу](http://127.0.0.1:80) `http://127.0.0.1:80/` либо воспользуйтесь терминалом:
  - `curl http://127.0.0.1:80/v1/current/?city=Moscow` - чтобы узнать текущую температуру в городе Moscow (можно использовать и другие города, хы)
  - `curl "http://127.0.0.1:80/v1/forecast/?city=Moscow&timestamp=3h"` - чтобы узнать прогноз погоды в интересующем Вас городе и используя *timestamp*:
    * `1h` - чтобы увидеть прогноз погоды на 1 час вперед
    * `3h` - чтобы увидеть прогноз погоды на 3 часа вперед
    * `tomorrow` - чтобы увидеть прогноз погоды на завтра в это же время
    * `yesterday` - чтобы увидеть какая погода была вчера в это же время






## Обновления:



## Инструментарий:
- GIT (устанавливается командой `sudo apt install git -y`)
- Docker (устанавливается командой `sudo apt install -y docker-ce`) [дополнительная инструкция](https://losst.ru/ustanovka-docker-na-ubuntu-16-04)
- Nginx (устанавливается командой `sudo apt install nginx`) [дополнительная инструкция](https://losst.ru/ustanovka-nginx-ubuntu-16-04)